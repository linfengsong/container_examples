
docker-job:
  stage: docker
  script: 
  - |
    echo "start build bcp docker image"
    
    mkdir -p $GITLAB_UTILS_PATH
    tar xf gitlab_utils.tar -C $GITLAB_UTILS_PATH
      
    env_name=dev
    srcPath=$(pwd)
    iniFilePath=$srcPath/conf/image_${env_name}.ini
    buildPath=$srcPath/target/build
      
    mkdir -p $buildPath/image
    cp -R $GITLAB_UTILS_PATH/build/* $buildPath
    if [[ ! -z "$CI_BUILD_PUBLISH_PATH" ]]; then cp -R $CI_BUILD_PUBLISH_PATH $buildPath/image; fi

    source $GITLAB_UTILS_PATH/script/oc_login.sh "$iniFilePath" $OC_ACCESS_ID "$OC_ACCESS_KEY"
    $GITLAB_UTILS_PATH/script/bcp_build.sh "$iniFilePath" "$buildPath"
    
    echo "finish build bcp docker image"
 